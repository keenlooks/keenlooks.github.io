---
title: "Adversarial Training for Raw-Binary Malware Classifiers"
collection: publications
permalink: /publications/2023-08-09-adversarial-training-for-raw-binary-malware-classifiers
redirect_from: 
  - /advtrmal/
  - /adv-train/
  - /AdvTrMal/
  - /advtrain-mal/
  - /adversarial-training-malware-classifiers/
date: 2023-08-09
venue_short: "USENIX Security '23"
venue: "32nd USENIX Security Symposium"
type: "Publication"
excerpt: ""
authors_short: "<u>K. Lucas</u>, S. Pai, W. Lin, L. Bauer, M. K. Reiter, and M. Sharif"
authors: "<u>Keane Lucas</u>, Samruddhi Pai, Weiran Lin, Lujo Bauer, Michael K. Reiter, and Mahmood Sharif"
citation: "Keane Lucas, Samruddhi Pai, Weiran Lin, Lujo Bauer, Michael K. Reiter, Mahmood Sharif. Adversarial Training for Raw-Binary Malware Classifiers. In Proc. USENIX Security '23."
paperurl: '/files/usenix-sec23-adversarial-training-malware-classifiers.pdf'
bibtex: /files/advtrain-mal.bib
---

Machine learning (ML) models have shown promise in classifying raw executable files (binaries) as malicious or benign with high accuracy. This has led to the increasing influence of ML-based classification methods in academic and real-world malware detection, a critical tool in cybersecurity. However, previous work provoked caution by creating variants of malicious binaries, referred to as adversarial examples, that are transformed in a functionality-preserving way to evade detection. In this work, we investigate the effectiveness of using adversarial training methods to create malware-classification models that are more robust to some state-of-the-art attacks. To train our most robust models, we significantly increase the efficiency and scale of creating adversarial examples to make adversarial training practical, which has not been done before in raw-binary malware detectors. We then analyze the effects of varying the length of adversarial training, as well as analyze the effects of training with various types of attacks. We find that data augmentation does not deter state-of-the-art attacks, but that using a generic gradient-guided method, used in other discrete domains, does improve robustness. We also show that in most cases, models can be made more robust to malware-domain attacks by adversarially training them with lower-effort versions of the same attack. In the best case, we reduce one state-of-the-art attackâ€™s success rate from 90% to 5%. We also find that training with some types of attacks can increase robustness to other types of attacks. Finally, we discuss insights gained from our results, and how they can be used to more effectively train robust malware detectors.

Please check out the [paper](/files/usenix-sec23-adversarial-training-malware-classifiers.pdf), [video](https://youtu.be/-_9olqD4HEI?si=ufCuQCHve9Ty7hob), or [code performing the transformations used in training](https://github.com/pwwl/enhanced-binary-diversification)! This code does not contain the attack algorithm.

<iframe width="560" height="315" src="https://www.youtube.com/embed/-_9olqD4HEI?si=gIQ8m4aXlp9VEZpP" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>